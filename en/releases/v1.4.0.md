# Excelize v1.4.0

* Released this on: August 14, 2018
* GitHub Release: [https://github.com/xuri/excelize/releases/tag/v1.4.0](https://github.com/xuri/excelize/releases/tag/v1.4.0)

## Release Notes

The most notable changes in this release are:

### API Changed

* Add error return value for functions: `AddChart()`, `AddComment()`, `AddPicture()`, `AddShape()`, `AddTable()` and `SetConditionalFormat()`

### Notable Features

* New function [`GetComments()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#File.GetComments) has been added for support retrieves all comments and returns a map of worksheet name to the worksheet comments
* New functions [`RGBToHSL()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#RGBToHSL) and [`HSLToRGB()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#HSLToRGB) has been added for support convert RGBA, HSL color
* New function [`NewDataValidation()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#NewDataValidation) and series functions [`DataValidation.SetDropList()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetDropList), [`DataValidation.SetError()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetError), [`DataValidation.SetInput()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetInput), [`DataValidation.SetRange()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetRange), [`DataValidation.SetSqref()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetSqref) and [`DataValidation.SetSqrefDropList()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#DataValidation.SetSqrefDropList) has been added for support data validation
* New function [`AddPictureFromBytes()`](https://pkg.go.dev/github.com/xuri/excelize@v1.4.0#File.AddPictureFromBytes) has been added, related issue [#259](https://github.com/xuri/excelize/issues/259)
* Function `GetCellFormula()` now supports shared formula types, related issue [#227](https://github.com/xuri/excelize/issues/227)
* Support to parse dates further in future
* Use min/mid/max value for 2 and 3 color scale conditional formatting

### Bug Fixes

* Improved commenting formatting, fix expands all comment boxes stacked all in one place
* Fix create worksheet by `NewSheet()` cause file issue, related issue [#249](https://github.com/xuri/excelize/issues/249)

### Performance

* Performance optimization 20% faster, 14% memory savings on set cell values. See [Performance Figures](https://github.com/xuri/excelize/wiki#performance-figures)
* Use [github.com/mohae/deepcopy](github.com/mohae/deepcopy) to deep copy worksheets instead of the internal `deepcopy` function that was using [encoding/gob](https://blog.golang.org/gobs-of-data) serialization and deserialization
