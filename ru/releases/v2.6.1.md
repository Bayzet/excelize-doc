# Excelize v2.6.1

* Версия выпущена: 22 Август 2022 г.
* Выпуск GitHub: [https://github.com/xuri/excelize/releases/tag/v2.6.1](https://github.com/xuri/excelize/releases/tag/v2.6.1)

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Переименуйте экспортированный тип `TabColor` в `TabColorRGB`
* Переименуйте экспортированную константу `TotalColumns` в `MaxColumns`
* Переименуйте экспортированную переменную `ErrMaxFileNameLength` в `ErrMaxFilePathLength`
* Переименуйте экспортированную переменную `ErrWorkbookExt` в `ErrWorkbookFileFormat`
* Удалить экспортированную переменную `ErrEncrypt`
* Изменить имя рабочего листа без учета регистра

### Примечательные особенности

* Новая поддержка 34 функций формул: CONVERT, COVARIANCE.S, DAVERAGE, DAYS360, DCOUNT, DCOUNTA, DGET, DMAX, DMIN, DPRODUCT, DSTDEV, DSTDEVP, DSUM, DVAR, DVARP, EDATE, EOMONTH, EUROCONVERT, GROWTH, HYPERLINK, MINVERSE, MMULT, NETWORKDAYS, NETWORKDAYS.INTL, PEARSON, RSQ, SKEW.P, SLOPE, STDEVPA, STEYX, TREND, WEEKNUM, WORKDAY, WORKDAY.INTL
* Добавить новую функцию `DeleteComment` для поддержки удаления комментария, связанная проблема [#849](https://github.com/xuri/excelize/issues/849)
* Функция `AddShape` теперь поддерживает назначение макроса фигуре
* Добавлена поддержка системы дат 1900 или 1904 года, связанная проблема [#1212](https://github.com/xuri/excelize/issues/1212)
* Добавить гиперссылку на ячейку обновления поддержки, связанная проблема [#1217](https://github.com/xuri/excelize/issues/1217)
* Функция `AddPicture` теперь позволяет вставлять изображения в форматах EMF, EMF, EMZ и WMZ, связанная проблема [#1225](https://github.com/xuri/excelize/issues/1225)
* Удалите сообщение об ошибке при открытии рабочей книги, новую экспортированную переменную `ErrWorkbookPassword` для сообщения об ошибке при получении неправильного пароля рабочей книги
* Новые экспортируемые константы `MinFontSize`, `MinColumns` и `MaxCellStyles`
* Добавлена поддержка формул массива для механизма расчета формул
* Поддержка шифрования книги паролем, связанная проблема [#199](https://github.com/xuri/excelize/issues/199)
* `RichTextRun` поддерживает установку верхнего и нижнего индекса с помощью атрибута `vertAlign`
* Функция `DeleteDataValidation` поддерживает удаление всех проверок данных на листе, связанная проблема [#1254](https://github.com/xuri/excelize/issues/1254)
* Механизм вычисления формулы поддерживает символ процентиля в выражении условия условия
* Механизм расчета формул поддерживает расчет формул зависимости, связанная проблема [#1262](https://github.com/xuri/excelize/issues/1262)
* Добавить параметр экспорта `MaxCalcIterations`, указывающий максимальное количество итераций для итеративного расчета
* Добавлен тип экспорта `ColorMappingType` для перечисления типов преобразования цвета
* Поддержка настройки диапазона таблицы при удалении и вставке столбца/строки
* Поддержка установки и получения индекса цвета, темы и оттенка для вкладки листа, связанная проблема [#1283](https://github.com/xuri/excelize/issues/1283)
* Добавлена новая функция экспорта `GetRowOpts` для итератора строк, чтобы поддерживать получение свойств строк, связанная проблема [#1296](https://github.com/xuri/excelize/issues/1296)

### Улучшение совместимости

* Улучшить совместимость с недопустимым количеством внутренних стилей, решенная проблема [#1211](https://github.com/xuri/excelize/issues/1211)
* Улучшить совместимость с Google Sheet, решенная проблема [#1244](https://github.com/xuri/excelize/issues/1244) и [#1314](https://github.com/xuri/excelize/issues/1314)
* Stream Writer теперь пропускает запись нулевых значений, когда устанавливает значение ячеек для строки, решенная проблема [#1299](https://github.com/xuri/excelize/issues/1299)

### Исправление ошибок

* Исправить сгенерированный файл, поврежденный, когда одно и то же поле используется для данных сводной таблицы и строк / столбцов, решенная проблема [#1203](https://github.com/xuri/excelize/issues/1203)
* Исправлено получение неправильного значения форматированного текста, вызванного отсутствием проверки типа ячейки, решенная проблема [#1213](https://github.com/xuri/excelize/issues/1213)
* Исправить некорректные результаты приведения типов данных ячеек при форматировании чисел, решенная проблема [#1219](https://github.com/xuri/excelize/issues/1219)
* Исправлена ошибка, из-за которой ячейка чтения была пустой, когда ячейка находится в стиле формата номера заполнителя 0, решенная проблема [#1312](https://github.com/xuri/excelize/issues/1312) и [#1313](https://github.com/xuri/excelize/issues/1313)
* Исправить установленное значение ячейки с проблемой наследования стиля столбца и строки, решенная проблема [#1163](https://github.com/xuri/excelize/issues/1163)
* Исправить панику при добавлении панели на пустой рабочий лист
* Исправлена проблема вычисления формулы с несколькими аргументами в некоторых случаях
* Исправить сгенерированный файл, поврежденный из-за неправильного порядка полей нижнего колонтитула заголовка рабочего листа, решенная проблема [#1257](https://github.com/xuri/excelize/issues/1257)
* Исправить установленное значение ячейки не удалось в некоторых случаях, решенная проблема [#1264](https://github.com/xuri/excelize/issues/1264)
* Исправить панику при установке или получении параметров просмотра листа на листе без параметров просмотра
* Исправление повреждений книги, вызванных пустыми созданными или измененными терминами dcterms в свойствах ядра документа
* Исправить отсутствующие свойства документа после создания нового рабочего листа, решенная проблема [#1298](https://github.com/xuri/excelize/issues/1298)

### Оптимизация производительности

* Улучшите производительность для набора строк листа и объединяющихся ячеек, устраните влияние на производительность при решении проблемы [#1129](https://github.com/xuri/excelize/issues/1129)
* Производительность вычисления формулы оптимизации
* Уменьшает использование памяти и ускоряет функцию `AddComment`, решении проблемы [#1310](https://github.com/xuri/excelize/issues/1310)

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены, сделал тестовый пример совместимым с go1.19
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

### Спасибо

Спасибо всем участникам Excelize. Ниже приведен список участников, внесших свой код в эту версию:

* @JDavidVR (David)
* @sceneq
* @Juneezee (Eng Zer Jun)
* @MichealJl (jialei)
* @ww1516123
* @z-hua (z.hua)
* @xdlrt (yeshu)
* @eaglexiang (Eagle Xiang)
* @MJacred
* @ReganYue (Regan Yue)
* @thomascharbonnel (Thomas Charbonnel)
* @ee0703 (EE)
* @NaturalGao (NaturalGao)
* @Sangua633
