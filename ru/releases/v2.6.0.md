# Excelize v2.6.0

* ыйдет: 11 апреля 2022 г.

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Переименуйте экспортированные константы `NameSpaceDublinCoreMetadataIntiative` в `NameSpaceDublinCoreMetadataInitiative` для исправления опечаток
* Удалите второй бесполезный параметр `isCurrentSheet` и возвраты ошибок функции `SetSqrefDropList`
* Удалить `TotalRows` из итератора строк

### Примечательные особенности

* `ProtectSheet` теперь поддерживает лист защиты с указанным алгоритмом: XOR, MD4, MD5, SHA1, SHA256, SHA384 и SHA512
* `UnprotectSheet` теперь поддерживает указанный второй необязательный параметр пароля для снятия защиты листа с проверкой пароля.
* Новая поддержка 23 функций формул: BETAINV, BETA.INV, CORREL, COVAR, COVARIANCE.P, ERROR.TYPE, EXPON.DIST, EXPONDIST, F.INV, F.INV.RT, FINV, FORMULATEXT, GAMMA.DIST, GAMMADIST, GAUSS, HOUR, INDIRECT, SECOND, SUMX2MY2, SUMX2PY2, SUMXMY2, TIMEVALUE, TYPE
* Добавлена новая экспортируемая ошибка `ErrWorkbookExt`, и проверьте расширение файла при сохранении книги
* Поддержка режима просмотра рабочей книги и настройки отображения линейки
* Улучшена поддержка числового формата, представлен модуль зависимостей NFP (number format parser) для пользовательского формата даты и времени, числовой формат и поддержка текстового заполнителя, включая местное название месяца и формат AM/PM на 19 языках (африкаанс, бангла, китайский, английский, французский, немецкий, австрийский, ирландский, итальянский, русский, испанский, тайский, тибетский, турецкий, валлийский, волоф, коса, йи и зулу) поддержка формата чисел, связанная проблема [#660](https://github.com/xuri/excelize/issues/660), [#764](https://github.com/xuri/excelize/issues/764), [#1093](https://github.com/xuri/excelize/issues/1093), [#1112](https://github.com/xuri/excelize/issues/1112), [#1133](https://github.com/xuri/excelize/issues/1133)
* Новые экспортированные функции `SetWorkbookPrOptions` и `GetWorkbookPrOptions` для поддержки настройки и получения свойств `FilterPrivacy` и `CodeName` книги, устраняют ограничения при добавлении проекта VBA в книгу, связанная проблема [#1148](https://github.com/xuri/excelize/issues/1148)
* Механизм формул теперь поддерживает расчет с формулой без параметров после записи инфиксного оператора.
* Поддержка чтения значения ячейки логического типа данных
* Поддержка установки размера отверстия при создании кольцевой диаграммы с помощью функции `AddChart`, решенная проблема [#1172](https://github.com/xuri/excelize/issues/1172)

### Улучшение совместимости

* Улучшена совместимость с LibreOffice, исправлена проблема, из-за которой автоматический фильтр не работал в LibreOffice, если в имени листа есть пробелы, решенная проблема [#1122](https://github.com/xuri/excelize/issues/1122)
* Улучшение совместимости с альтернативным содержимым, поддержка сохранения альтернативного содержимого в книге, листе и drawingML

### Исправление ошибок

* Исправить отсутствующую настройку страницы рабочего листа после повторного сохранения электронной таблицы, решенная проблема [#1117](https://github.com/xuri/excelize/issues/1117)
* Исправлена ошибка, из-за которой объединенные ячейки не обновлялись после операции в некоторых случаях
* Исправить проблему синтаксического анализа стиля, из-за которой отсутствовал жирный шрифт и другие стили, решенная проблема [#1119](https://github.com/xuri/excelize/issues/1119)
* Исправьте файл, поврежденный при сохранении, как в расширении XLAM / XLSM / XLTM / XLTX в некоторых случаях
* Исправьте стиль ячеек в диапазоне слияния, заставьте ячейку поддерживать стиль столбцов/строк наследования, решенная проблема [#1129](https://github.com/xuri/excelize/issues/1129)
* Исправлен неправильный идентификатор стиля, возвращаемый при получении стиля ячейки в некоторых случаях
* Исправлен неправильный формат номера сборки: 42
* Исправлена ошибка синтаксического анализа десятичной точности в некоторых случаях
* `SetCellDefault` поддерживает нечисловое значение, решенная проблема [#1139](https://github.com/xuri/excelize/issues/1139)
* Фиксированная настройка отображения вкладок листа отсутствовала при сохранении в виде электронной таблицы в некоторых случаях, решенная проблема [#1160](https://github.com/xuri/excelize/issues/1160)
* Исправить ошибку результата вычисления вложенной формулы, решенная проблема [#1164](https://github.com/xuri/excelize/issues/1164)

### Оптимизация производительности

* Улучшите производительность потокового чтения на основе ранее выпущенной версии, уменьшите использование памяти максимум примерно на 50% для чтения больших электронных таблиц данных и сократите на 80% время GC для итератора строки.

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен
