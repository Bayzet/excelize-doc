# Excelize v2.5.0

* Выйдет: 3 Январь 2022 г.

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

* Требуется закрыть электронную таблицу и итератор строки, пользователь должен закрыть поток после использования итератора строки и закрыть электронную таблицу после открытия существующей электронной таблицы
* Измените `ReadZipReader` как реализацию `File`, извлеките электронную таблицу с заданными параметрами и поддержите извлечение в памяти или касание файловой системы

### Примечательные особенности

* Новый API: поддержка `SetRowStyle` для заданного стиля для строк, связанная проблема [#990](https://github.com/xuri/excelize/issues/990)
* Новый API: поддержка `GetCellType` для получения типа данных ячейки, связанная проблема [#417](https://github.com/xuri/excelize/issues/417) и [#520](https://github.com/xuri/excelize/issues/520)
* `GetCellValue`, `GetRows`, `GetCols`, `Rows` и `Cols` поддерживают указание читаемой ячейки с необработанным значением, связанная проблема [#621](https://github.com/xuri/excelize/issues/621)
* Новая поддержка 12 функций формул: DATEVALUE, DAY, DAYS, MATCH, MONTH, TRANSPOSE, WEIBULL, WEIBULL.DIST, XOR, YEAR, Z.TEST, ZTEST, связанная проблема [#1002](https://github.com/xuri/excelize/issues/1002)
* Механизм вычисления формул поддерживает вложенные вычисления для формулы `IF`, связанная проблема [#987](https://github.com/xuri/excelize/issues/987)
* Поддержка механизма вычисления формул получить общую формулу, связанная проблема [#844](https://github.com/xuri/excelize/issues/844)
* Сравнение текста поддержки механизма вычисления формул, связанная проблема [#998](https://github.com/xuri/excelize/issues/998)
* Поддержка указать формулу в диапазоне проверки данных, связанная проблема [#1012](https://github.com/xuri/excelize/issues/1012)
* Поддержка указанного ограничения размера распаковки для параметров открытого файла, предотвращение атак на уязвимость с помощью zip-бомб
* SetCellFormula теперь поддерживает установку общей формулы
* UpdateLinkedValue пропустит лист макросов, связанная проблема [#1014](https://github.com/xuri/excelize/issues/1014)
* Исправить `AddPicture`, создававшее дублирующееся изображение в некоторых случаях, вызванное неправильным вычислением идентификатора внутренних отношений, связанная проблема [#1017](https://github.com/xuri/excelize/issues/1017)
* `AddShape` поддерживает установку ширины линии для добавления фигуры, связанная проблема [#262](https://github.com/xuri/excelize/issues/262)
* Добавлены новые параметры `WorksheetUnzipMemLimit`, поддержка указания лимита памяти при распаковке рабочего листа в байтах
* Будет возвращена ошибка, если при создании нового стиля указан недопустимый пользовательский числовой формат, связанная проблема [#1028](https://github.com/xuri/excelize/issues/1028)
* Теперь поддерживается установка стиля строки в потоковом писателе.
* Удалите неиспользуемую экспортированную переменную ошибки `ErrToExcelTime`

### Улучшение совместимости

* Улучшена совместимость с элементом строки с атрибутом `r="0"`
* Сохранить управляющий символ XML

### Исправление ошибок

* Исправить ошибку при удалении проверки данных, решенная проблема [#979](https://github.com/xuri/excelize/issues/979)
* В некоторых случаях сбой в раскрывающемся списке проверки данных набора исправлений, решенная проблема [#986](https://github.com/xuri/excelize/issues/986)
* Механизм вычисления исправления формул `LOOKUP` некорректно обрабатывает форму массива, решенная проблема [#994](https://github.com/xuri/excelize/issues/994)
* Механизм вычисления исправлений формул `LOOKUP` может найти только точное совпадение, решенная проблема [#997](https://github.com/xuri/excelize/issues/997)
* Исправить неправильно рассчитанные процентные значения формулы, решенная проблема [#993](https://github.com/xuri/excelize/issues/993)
* Исправить панику, вызванную неправильным чтением ячейки в некоторых случаях
* Исправить условный формат нижней части N не работает
* Устранить проблему точности синтаксического анализа времени, решенная проблема [#1026](https://github.com/xuri/excelize/issues/1026)
* Не удалось исправить встроенный формат научных чисел, решенная проблема [#1027](https://github.com/xuri/excelize/issues/1027)

### Оптимизация производительности

* Ускорение затрат времени на объединение ячеек, снижение затрат времени более чем на 90%
* Повышение производительности потокового чтения, уменьшение использования памяти примерно на 93.7%

### Другие

* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен
