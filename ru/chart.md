# Диаграмма

## Добавить диаграмму {#AddChart}

```go
func (f *File) AddChart(sheet, cell, format string, combo ...string) error
```

AddChart предоставляет метод добавления диаграммы на листе с помощью заданного набора формата диаграммы (например, смещение, масштаб, настройка соотношения сторон и параметры печати) и набор свойств.

Ниже показано `type` диаграммы, поддерживаемый excelize:

Тип|Диаграмма
---|---
area                        | 2D диаграмма области
areaStacked                 | 2D диаграмма области с накоплением
areaPercentStacked          | 2D 100% диаграмма области с накоплением
area3D                      | 3D диаграмма области
area3DStacked               | 3D диаграмма области с накоплением
area3DPercentStacked        | 3D 100% диаграмма области с накоплением
bar                         | 2D кластерная гистограмма
barStacked                  | 2D Двухстрочная гистограмма
barPercentStacked           | 2D 100% сложная гистограмма
bar3DClustered              | 3D кластерная гистограмма
bar3DStacked                | 3D гистограмма
bar3DPercentStacked         | 3D 100% сложная гистограмма
bar3DConeClustered          | 3D конус кластерных диаграммы бар
bar3DConeStacked            | 3D конус штабелироваться диаграммы бар
bar3DConePercentStacked     | 3D 100% диаграмма конусной панели
bar3DPyramidClustered       | 3D пирамида кластерных диаграмма бара
bar3DPyramidStacked         | 3D пирамиды сложены диаграммы бар
bar3DPyramidPercentStacked  | 3D 100% пирамиды сложены диаграммы бар
bar3DCylinderClustered      | 3D цилиндровый кластерный бар диаграммы
bar3DCylinderStacked        | 3D цилиндр штабелироваться бар диаграммы
bar3DCylinderPercentStacked | 3D 100% цилиндр штабелироваться бар диаграммы
col                         | 2D группированная диаграмма столбцов
colStacked                  | 2D сложены диаграммы колонки
colPercentStacked           | 2D 100% сложены диаграммы колонки
col3D                       | 3D диаграмма столбца
col3DClustered              | 3D группированная диаграмма столбцов
col3DStacked                | 3D сложены диаграммы колонки
col3DPercentStacked         | 3D 100% сложены диаграммы колонки
col3DCone                   | 3D Диаграмма столбца конуса
col3DConeClustered          | 3D конус кластерных диаграмма столбца
col3DConeStacked            | 3D конус штабелироваться диаграммы колонки
col3DConePercentStacked     | 3D 100% конус штабелироваться диаграммы колонки
col3DPyramid                | 3D диаграмма столбца пирамиды
col3DPyramidClustered       | 3D пирамида кластерных диаграмма столбца
col3DPyramidStacked         | 3D пирамида сложены диаграммы колонки
col3DPyramidPercentStacked  | 3D 100% пирамиды сложены диаграммы столбца
col3DCylinder               | 3D диаграмма цилиндрической колонки
col3DCylinderClustered      | 3D цилиндр кластерных столбцов диаграммы
col3DCylinderStacked        | 3D цилиндр штабелироваться диаграммы колонки
col3DCylinderPercentStacked | 3D 100% цилиндр штабелироваться диаграммы колонки
doughnut                    | диаграмма пончика
line                        | линейный график
pie                         | круговая диаграмма
pie3D                       | 3D круговая диаграмма
radar                       | радиолокационная карта
scatter                     | диаграмма рассеяния
surface3D                   | 3D поверхностная диаграмма
wireframeSurface3D          | 3D диаграмма поверхности проволоки
contour                     | контурная диаграмма
wireframeContour            | диаграмма контура каркасной проволоки
bubble                      | пузырь диаграммы
bubble3D                    | 3D пузырь диаграммы

В области данных диаграммы Office Excel `series` определяет набор информации, для которой данные рисовать, легенда пункт (серии), и горизонтальной (категория) метки оси.

Параметры `series`, которые могут быть установлены:

Параметр|Объяснение
---|---
name|Элемент легенды (серия), отображаемый в легенде диаграммы и в строке формул. Параметр `name` является необязательным. Если вы не укажете это значение, по умолчанию будет `Series 1 .. n`. `name` для представления формул, например: `Sheet1!$A$1`.
categories|Горизонтальная (категория) метка оси. Параметр `categories` является необязательным в большинстве типов диаграмм, по умолчанию это непрерывная последовательность формы `1..n`.
values|Область данных диаграммы, которая является наиболее важным параметром в `series`, является единственным обязательным параметром при создании диаграммы. Этот параметр связывает диаграмму с отображаемыми данными листа.
line|Устанавливает формат линии графика. Свойство `line` является необязательным, и если оно не указано, оно будет использовать стиль по умолчанию. Параметры, которые можно установить, это ширина. Диапазон `width` составляет 0.25pt - 999pt. Если значение ширины находится за пределами диапазона, ширина линии по умолчанию составляет 2pt.
marker|Это устанавливает маркер линейной диаграммы и точечной диаграммы. Диапазон необязательного поля `size` составляет от 2 до 72 (значение по умолчанию `5`). Значением перечисления необязательного поля `symbol` являются (значение по умолчанию - `auto`): `circle`, `dash`, `diamond`, `dot`, `none`, `picture`, `plus`, `square`, `star`, `triangle`, `x`, `auto`.

Задайте свойства легенды диаграммы. Возможные параметры:

Параметр|Тип|Объяснение
---|---|---
none|bool|Укажите, следует ли отображать легенду без перекрытия диаграммы. Значение по умолчанию - `false`
position|string|Позиция легенды диаграммы
show_legend_key|bool|Задайте ключи легенды, которые будут отображаться в метках данных

Установите `position` легенды диаграммы. Положение легенды по умолчанию - `right`. Этот параметр действует, только если `none` имеет значение `false`. Доступные позиции:

Параметр | Объяснение
---|---
top       | верх
bottom    | дно
left      | оставил
right     | правильно
top_right | в правом верхнем углу

Параметр `show_legend_key`, задающий ключи легенды, должен отображаться в метках данных. Значение по умолчанию равно `false`.

Название диаграммы задается путем выбора параметра `name` объекта `title`, и заголовок будет отображаться над диаграммой. Параметр `name` поддерживает использование представлений формул, таких как `Sheet1!$A$1`, если вы не укажете заголовок значка, значение по умолчанию равно null.

Параметр `show_blanks_as` предоставляет настройку «Скрыть и пустые ячейки». Значение по умолчанию: `gap` т.е. «пустая ячейка отображается как»: «пространство». Ниже приведены необязательные значения для этого параметра:

Параметр | Объяснение
---|---
gap  | пространство
span | Соединить точки данных с прямыми линиями
zero | нулевое значение

Указывает, что каждый маркер данных в серии имеет различный цвет на `vary_colors`. Значение по умолчанию является `истинным`.

Параметр `format` предоставляет параметры для таких параметров, как смещение графика, масштаб, параметры соотношения сторон и свойства печати, а также те, которые используются в функции [`AddPicture()`](image.md#AddPicture).

Задайте положение области графика по площади участка. Свойства, которые могут быть установлены:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
show_bubble_size|bool|`false`|Указывает, что размер пузырька должен быть указан на метке данных.
show_cat_name|bool|`true`|Название категории
show_leader_lines|bool|`false`|Указывает, что имя категории должно отображаться на метке данных.
show_percent|bool|`false`|Указывает, что процент отображается в метке данных.
show_series_name|bool|`false`|Указывает, что имя серии должно отображаться в метке данных.
show_val|bool|`false`|Указывает, что значение должно отображаться на метке данных.

Задайте основные параметры горизонтальной и вертикальной оси с помощью `x_axis` и `y_axis`.

Свойства `x_axis`, которые можно установить:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
none|bool|`false`|Отключить оси.
major_grid_lines|bool|`false`|Определяет основные линии сетки.
minor_grid_lines|bool|`false`|Определяет второстепенные линии сетки.
tick_label_skip|int|`1`|Определяет, сколько тиковых меток пропустить между нарисованными метками. Свойство `tick_label_skip` является необязательным. Значением по умолчанию является авто.
reverse_order|bool|`false`|Указывает, что категории или значения в обратном порядке (ориентация диаграммы). Свойство `reverse_order` является необязательным.
maximum|int|`0`|Указывает, что фиксированный максимум 0 автоматически. Максимальное свойство необязательно.
minimum|int|`0`|Указывает, что фиксированный минимум 0 является авто. Минимальное свойство необязательно. Значение по умолчанию автоматически.

Свойства `y_axis`, которые можно установить:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
none|bool|`false`|Отключить оси.
major_grid_lines|bool|`false`|Определяет основные линии сетки.
minor_grid_lines|bool|`false`|Определяет второстепенные линии сетки.
major_unit|float64|`0`|Определяет расстояние между основными тиками. Должен содержать положительное число с плавающей точкой. Свойство major_unit является необязательным. Значением по умолчанию является авто.
reverse_order|bool|`false`|Указывает, что категории или значения в обратном порядке (ориентация диаграммы). Свойство `reverse_order` является необязательным.
maximum|int|`0`|Указывает, что фиксированный максимум 0 автоматически. Максимальное свойство необязательно.
minimum|int|`0`|Указывает, что фиксированный минимум 0 является авто. Минимальное свойство необязательно. Значение по умолчанию автоматически.

Установите размер диаграммы по свойству `dimension`. Свойство измерения необязательно. Свойства, которые могут быть установлены:

Параметр|Тип|По умолчанию|Объяснение
---|---|---|---
height|int|290|Высота
width|int|480|Ширина

Параметр `combo` определяет создание диаграммы, которая объединяет два или более типов диаграммы в одну диаграмму. Например, создайте кластеризованную столбчатую диаграмму с данными `Sheet1!$E$1:$L$15`:

```go
package main

import (
    "fmt"

    "github.com/xuri/excelize/v2"
)

func main() {
    categories := map[string]string{
        "A2": "Small", "A3": "Normal", "A4": "Large",
        "B1": "Apple", "C1": "Orange", "D1": "Pear"}
    values := map[string]int{
        "B2": 2, "C2": 3, "D2": 3, "B3": 5, "C3": 2, "D3": 4, "B4": 6, "C4": 7, "D4": 8}
    f := excelize.NewFile()
    for k, v := range categories {
        f.SetCellValue("Sheet1", k, v)
    }
    for k, v := range values {
        f.SetCellValue("Sheet1", k, v)
    }
    if err := f.AddChart("Sheet1", "E1", `{
        "type": "col",
        "series": [
        {
            "name": "Sheet1!$A$2",
            "categories": "Sheet1!$B$1:$D$1",
            "values": "Sheet1!$B$2:$D$2"
        },
        {
            "name": "Sheet1!$A$3",
            "categories": "Sheet1!$B$1:$D$1",
            "values": "Sheet1!$B$3:$D$3"
        }],
        "format":
        {
            "x_scale": 1.0,
            "y_scale": 1.0,
            "x_offset": 15,
            "y_offset": 10,
            "print_obj": true,
            "lock_aspect_ratio": false,
            "locked": false
        },
        "legend":
        {
            "position": "left",
            "show_legend_key": false
        },
        "title":
        {
            "name": "2D группированная диаграмма столбцов - линейный график"
        },
        "plotarea":
        {
            "show_bubble_size": true,
            "show_cat_name": false,
            "show_leader_lines": false,
            "show_percent": true,
            "show_series_name": true,
            "show_val": true
        }
    }`, `{
        "type": "line",
        "series": [
        {
            "name": "Sheet1!$A$4",
            "categories": "Sheet1!$B$1:$D$1",
            "values": "Sheet1!$B$4:$D$4"
        }],
        "format":
        {
            "x_scale": 1.0,
            "y_scale": 1.0,
            "x_offset": 15,
            "y_offset": 10,
            "print_obj": true,
            "lock_aspect_ratio": false,
            "locked": false
        },
        "legend":
        {
            "position": "right",
            "show_legend_key": false
        },
        "plotarea":
        {
            "show_bubble_size": true,
            "show_cat_name": false,
            "show_leader_lines": false,
            "show_percent": true,
            "show_series_name": true,
            "show_val": true
        }
    }`); err != nil {
        fmt.Println(err)
        return
    }
    // Сохранить workbook
    if err := f.SaveAs("Book1.xlsx"); err != nil {
        fmt.Println(err)
    }
}
```

## Добавить лист диаграммы {#AddChartSheet}

```go
func (f *File) AddChartSheet(sheet, format string, combo ...string) error
```

AddChartSheet предоставляет метод для создания листа диаграммы по заданному набору формата диаграммы (например, смещение, масштаб, настройка соотношения сторон и настройки печати) и набору свойств. В Excel лист диаграммы - это рабочий лист, который содержит только диаграмму.

## Удалить диаграмму {#DeleteChart}

```go
func (f *File) DeleteChart(sheet, cell string) (err error)
```

DeleteChart предоставляет функцию для удаления диаграммы в XLSX по заданному рабочему листу и имени ячейки.
